<!DOCTYPE html>
<!--
Performs best on google.
If it's not loading, you can use the boring, but faster version here: 


-->
<html>
    <head>
    <script>
        //localStorage.removeItem("kausername")
        //localStorage.setItem("exchangePromiseVerification", "yep");
       //localStorage.setItem("exchangeAvatar", "0")
        ///localStorage.removeItem("exchangePromiseVerification");
    //localStorage.removeItem("exchangeAvatar");
    </script>
        <meta charset="utf-8">
        <title>Wip!!!!!</title>
       <script src="https://cdn.jsdelivr.net/npm/party-js@latest/bundle/party.min.js"></script>
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet">
        <link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Audiowide&family=Recursive:wght@300&display=swap" rel="stylesheet">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/animejs@3.0.1/lib/anime.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script>
        <style>
        ::-webkit-scrollbar {
            display: none;
        }
            #menuPage {
                overflow-y: auto;
                background: rgba(0, 0, 0, 0.6);
                position: absolute;
                top: 0px;
                left: 10px;
                width: 580px;
                height: 500px;
                color: white;
                font-family: "AudioWide";
            }
            body {
                overflow-x: hidden;
                overflow-y: hidden;
                
            }
            .backgroundGrid {
                width: 5%;
                height:5%;
                position: absolute;
                background-color: rgba(199, 199, 199);
                z-index: 10;
            }
            #homePageMainHeader {
                background-color: rgba(0, 0, 0, 0.4);
                z-index: 1;
                color: white;
                text-align: center;
                font-family: "AudioWide";
                border: 3px solid white;
                position: absolute;
                top: 10px;
                left: 10px;
                width: 573px;
                box-shadow: 10px 15px 5px rgba(0, 0, 0, 0.7);
                 
            }
            #homePageSubHeader {
                border-top: 3px solid white;
                padding-top: 10px;
            }
            #homeBackImage {
                position: absolute;
                top: 0px;
                left:0px;
                height: 500px;
                filter: brightness(70%);
            }
            #login {
                position: absolute;
                top: 200px;
                left: 150px;
                width:300px;
                height: 50px;
                font-size: 20px;
                background-color:rgba(0, 0, 0, 0.7);
                color: white;
                text-align: center;
                border: 3px solid white;
                font-family: "AudioWide";
            }
            #login:hover {
                border: 3px solid blue;
            }
            #homePageLoginHeader {
                position: absolute;
                top: 153px;
                left: 150px;
                color: white;
                border: 3px solid white;
                width: 304px;
                text-align: center;
                font-family: "AudioWide";
            }
            #loginButton {
                position: absolute;
                left: 150px;
                width: 310px;
                top: 267px;
                font-family: "AudioWide";
                height: 40px;
                border: 3px solid white;
            }
            #loginButton:hover {
                border: 3px solid blue;
            }
            #homePagePasswordHeader {
                position: absolute;
                top: 237px;
                left: 150px;
                border: 3px solid white;
                font-family: "AudioWide";
                color: white;
                width: 304px;
                text-align: center;
            }
            #password {
                 position: absolute;
                top: 283px;
                left: 150px;
                width:300px;
                height: 50px;
                font-size: 20px;
                background-color:rgba(0, 0, 0, 0.7);
                color: white;
                text-align: center;
                border: 3px solid white;
                font-family: "AudioWide";
                
            }
            #loadText {
                text-align: center;
                width: 580px;
                position: absolute;
                top: 145px;
                left: 5px;
                border: 3px dashed white;
                color: white;
               
            }
            .head {
                  color: rgb(255, 255, 255);
                text-align: center;
            }
            .menuHead {
                border: 3px solid white;
                border-top-left-radius: 10px;
                padding: 10px;
            }
            #war {
                margin-left:30px;
                margin-right: 30px;
                text-align: center;
                border: 3px solid blue;
                padding: 5px;
                box-shadow:  0 0 50px blue;
            }
            footer {
                text-align: center;
                padding: 5px;
                margin-top: 20px;
                margin-bottom: 20px;
          background: -webkit-linear-gradient(#FFFFFF,#0000FF) 	;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;

            }
            footer a {
                border-bottom: 3px solid white;
                
            }
            footer a:hover {
                border-bottom: 3px solid blue;
            }
           
            .navBar {
              padding: 3px;
             color: white;
              margin-top:23px;
              margin-bottom: 23px;
              margin-left: 15px;
              margin-right: 15px;
              text-decoration: none;
                
            }
            .navBar:hover{
                box-shadow:0 0 15px blue;
                background-color: rgba(0, 0, 255, 0.7);
                 text-shadow: 0 0 5px white;
            }
            #nav  {
               border-top: 3px solid white;
               padding: 10px;
                 
                
            }
           header {
               text-align: center;
               border:3px solid white;
               margin-top: 5px;
           }
           #animeBar {
               position: absolute;
               width: 100px;
               top: 73px;
               left: 112px;
               z-index: 1000;
               background-color: blue;
               height: 10px;
           }
           .norm {
               background-color: rgb(230, 230, 230);
               border: 2px solid white;
               font-family: "audiowide";
               text-decoration: underline;
               color: black;
           }
           .norm:hover {
               background-color: rgb(93, 90, 176);
               background-color: rgb(200, 200, 200);
           }
           #profile {
               margin-top: 20px;
               margin-bottom: 20px;
               border: 6px double rgb(255, 255, 255);
               border-radius: 3px;
               
               /*background-color:rgba(110, 91, 252, 0.4);*/
               background-image: url("https://upload.wikimedia.org/wikipedia/en/b/bb/Graduated_Blue_Background.png");
               
               
           }
           #profileName {
               
               color: white;
               padding-left: 10px;
               filter: none;
               letter-spacing: 1.5px;
               font-size: 30px;
           }
           #profileName a {
               color: white;
               
           }
           #profileName a:hover {
               color: rgba(230, 230, 230);
           }
           
           #moolah {
               position: relative;
               top:-5px;
               font-size: 30px;
           }
           #profile .material-icons{
              transform: rotate(100deg);
              font-size: 35px;
           }
           #avatar {
               background-color:rgba(140, 140, 140);
               border-radius: 10px;
           }
           #avatar:hover {
               cursor: pointer;
               background-color: rgba(120, 120, 120);
           }
           #profileTime {
              
               font-size: 20px;
               z-index: 100000;
           }
        </style>
    </head>
    <body>

<script src="https://cdn.jsdelivr.net/npm/party-js@latest/bundle/party.min.js"></script>

<img src = "https://upload.wikimedia.org/wikipedia/commons/d/d7/Philippine-stock-market-board.jpg" id = "homeBackImage" >
<div id = "home">
<div id = "homePageMainHeader">
    <h1 >The Stock Exchange</h1>
    <h3 id = "homePageSubHeader">KA's First Person to Person Stock Trading Game!</h3>
</div>
<h3 id = "homePageLoginHeader">Your Username:</h3>

    <input id = "login"type = "text"value="???">
    
   
<button id = "loginButton">Enter</button>
</div>
<div id = "loading">
    <h3 id = "loadText">Loading...</h3>
</div>
<div id = "menu">
<div id= "menuPage">
<div id = "animeBar"></div>
<header>
    <h1>The Stock Exchange</h1>
    

    <div id = "nav">
        <a class = "navBar" href = "javascript:">Home</a>

        <a class = "navBar" href = "javascript:">Buy</a>
        <a class = "navBar" href = "javascript:">Sell</a>
        <a class = "navBar" href = "javascript:">Stats</a>
        <a class = "navBar" href = "javascript:">Season</a>
        <a class = "navBar" href = "javascript:">News</a><a></a>
    </div>
   
</header>
    
         <br>
        <div id = "war"><p>Welcome to The Stock Exchange, a place to trade stocks and have fun! By using this website you accept that you will not attempt to cheat in any way, manipulate the code  or account data in any way, or attempt to further yourself in this game by breaking rules. Any such actions will result in automatic or manual account banning.</p><button class = "norm"onclick="verified();">Accept</button></div>
        <div id = "profile">
               <h3 id = "profileName"><span id = "avatar"></span> <a id = "welc" target = "_blank"></a></h3>
                <span class="material-icons">paid</span><span id = "moolah"></span><span id = "profileTime"></span>
                   <h3 class = "menuHead">Notifications</h3>
        <div id = "notifs"></div>
        </div>
     
       
        <footer>Copyright <span id = "year"> </span> by <a id = "authorCD911" href = "https://www.khanacademy.org/computer-programming/coders-digest-911-hq/4663674250149888" target = "_blank">Coder's Digest 911</a></footer>
</div>

</div>
<script>
var selectedAvatar = 0;
var avatars = [
"üê∂",
"üê∫",
"ü¶ù",
"üê±",
"ü¶Å",
"üê¥",
"üêÆ",
"üê∑",
"üê≠",
"üêπ",
"üê∏",
"üêØ",
"üê®",
"üêª",
"üê∞",
"ü¶¢",
"üêø",
"‚õÑ",
"üê¨",
];
var signature;
var KAusername;
var proURL;
var coSign;
if(localStorage.getItem("exchangeAvatar")){
    
}else {
    localStorage.setItem("exchangeAvatar", 0)
}
    var c;
        var allData;
        var accData = [];
        var final = [];
var pages = ["home", "loading", "menu"];
     function verified (){
         localStorage.setItem("exchangePromiseVerification"+KAusername, "yep")
         $("#war").fadeOut(1500);
     }
     function loadPage (page){
        for(var i = 0; i < page.length; i++){
            $("#"+pages[i]).hide();
        }
        $("#"+page).hide().fadeIn();
        
    };
    //localStorage.setItem("exchangePromiseVerification", "yep");
    
   

    

    function printData (){
        $("#welc").text(localStorage.getItem("kausername"))
        $("#moolah").text(" " +final[0])
        $("#avatar").text(avatars[localStorage.getItem("exchangeAvatar")])
        $("#welc").attr("href", proURL)
         if(localStorage.getItem("exchangePromiseVerification"+KAusername)){
        if(localStorage.getItem("exchangePromiseVerification"+KAusername)==="yep"){
        $("#war").hide();
}}
        
    }
    function process (str){
        signature = str.substr(0, 8);
        coSign = str.substr(8, 4)
        switch (signature){
            case "|--|-/||":
                //alert("yo")
                if(coSign === "(||)"){
                    final.push(str.substr(12, str.length-12));
                    //alert(final)
                    //break;
                }
            break;
            
        }
    }
    
     function dataChug (){
     
        var last=-1;
        /* if(localStorage.getItem("kausername")){
             KAusername === localStorage.getItem("kausername");
             
         }else{
                KAusername = document.getElementById("login").value;//gets login
                localStorage.setItem("kausername", KAusername)
         }*/
         if(localStorage.getItem("kausername")){
             KAusername = localStorage.getItem("kausername")
         }else{
         KAusername = document.getElementById("login").value;//gets login
         localStorage.setItem("kausername", KAusername)
         }
        var link = "https://www.khanacademy.org/api/internal/discussions/scratchpad/";
        var ID = "5157049980633088";
        
        $.getJSON(link+ ID +"/comments?callback=?", function(data){//gets all comments JSON
            
     for(var i = 0; i < data.feedback.length; i++){
         
         if(data.feedback[i].content.substring(0, 12) ==="*My Account*"){
             if(data.feedback[i].authorNickname === KAusername){
                  proURL = "https://www.khanacademy.org/profile/"+data.feedback[i].authorKaid;
                    
                //alert(data.feedback[i].authorNickname + " " + data.feedback[i].expandKey);
                loadPage("loading");
                var expandKey = data.feedback[i].expandKey;
                $.getJSON("https://www.khanacademy.org/api/internal/discussions/"+expandKey+"/replies?callback=?", function(d){
                   
                    
          for(var l = 0; l < d.length; l++){
                        
                    
                        
                         if(d[l].content.substr(0, 8) === "|-|-|-(-"&&d[l].content.substr(d[l].content.length-8, d[l].content.length) === "-)-|-|-|"){
                             if(l>last){
                                 last = l;
                             }
                            
                         }
                    }
                    var end = d[last].content.length;
                   accData = d[last].content.substr(9, end-18).split(" ");
                   for(var z = 0; z < accData.length; z++){
                       process(accData[z])
                   }
                   printData();
                   loadPage("menu");
                   //$("#loadText").text(accData[0])
                  // alert(accData + accData.length)
                    //break;
                })
             break;
             
             }
         }
         if(i === data.feedback.length){
            
             alert("Oh Noes! Something went wrong. Ensure that the username you entered is the same as your real name (the one the appears in the Tips and Thanks, and below your programs) and that you've completed the sign up process!")
         }
     }
    })
        
     }  
</script>
<script>
//localStorage.removeItem("kausername")
if(localStorage.getItem("kausername")){
      dataChug();
    loadPage("menu")
  
}else{

loadPage("home")
}
$("#avatar").on("click", function(){
    selectedAvatar++;
    if(selectedAvatar === avatars.length){
        selectedAvatar = 0;
    }
    localStorage.setItem("exchangeAvatar", selectedAvatar)
    $("#avatar").text(avatars[localStorage.getItem("exchangeAvatar")])
    
})
$("#loginButton").on("click", function(){
       dataChug();
     })
         
     </script>

<script>
    anime({
        
            targets:"#animeBar",
            translateX: {
                value: 260 + "px",
                duration: 2000,
            },
            
            
            
            direction: "alternate",
            loop: true,
            easing:"easeInOutSine"
        
    })
anime({
    targets: "#profile .material-icons",
    
        rotate: "2turn",
        duration: 2000,
        direction: "alternate",
        loop: true,
        easing: "easeInOutSine"
    
})
    
</script>
<script>
    $("#year").text(moment()
    .format('YYYY')
    )//
    //setInterval(function(){
       // $("#profileTime").text(moment().format('MMMM Do h:mm'))}
        //, 900)
   // $("#profileTime").text(moment().format('MMMM Do h:mm:ss'))
</script>
<script>
var repeat;
    document.getElementById("avatar").addEventListener("click", function (e) {
        party.resolvableShapes["ava"] = "<h1>"+avatars[selectedAvatar]+"</h1>"
    party.confetti(this, {
        
    shapes: ["ava"],
        count: party.variation.range(20, 40),
    });
});
   
var coolish;
document.getElementById("authorCD911").addEventListener("mouseover", function(){
    party.resolvableShapes["myImage"] = '<img src="https://cdn.kastatic.org/images/avatars/svg/stelly-yellow.svg" width = "100">';
   party.confetti(document.getElementById("authorCD911"), {
         shapes: ["myImage"],
        count: party.variation.range(20, 2),
        
    });
      coolish = setInterval(function(){
         party.confetti(document.getElementById("authorCD911"), {
         shapes: ["myImage"],
        count: party.variation.range(20, 20),
        
    });
    }, 1000)
    
})
document.getElementById("authorCD911").addEventListener("mouseout", function(){
    clearInterval(coolish)
    
})

</script>
    </body>
</html>
